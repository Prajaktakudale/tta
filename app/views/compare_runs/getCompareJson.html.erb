<%= javascript_include_tag 'util/templates' %>
<%= javascript_include_tag 'util/utils' %>
<%= render 'layouts/compare_partial' %>

<script type="text/javascript">
    $(document).ready(function () {

        var displayCompareResults = function (compareJson) {
            $("#project_select").attr("disabled", "disabled");
            var ResultType = "",
                    templates = new Template(),
                    CompareTable = templates.getCompareTableTemplate();
            var classNames = "<tr><th>CLASS-NAMES</th></tr>",
                    class_name_array = compareJson.both_failing,

                    resultType = "<h3><b>TEST-CASES FAILING ON BOTH \"" + compareJson.dates[0] + "\" AND \"" + compareJson.dates[1] + "\"<b></b></h3>";

            for (var index = 0; index < class_name_array.length; index++) {
                classNames += templates.render(CompareTable, {
                    "ClassName": class_name_array[index]
                });
            }

            if (class_name_array.length < 2) {
                $("#result_table").css("display", "none");
                resultType = "<h3><b>NO SAME TEST-CASES FAILING ON BOTH \"" + compareJson.dates[0] + "\" AND \"" + compareJson.dates[1] + "\"<b></b></h3>";
            }
            else {
                $("#result_type").html();
                $("#result_table").html(classNames);
            }
            $("#result-title").html(resultType);

        }
        var compareJson;
        compareJson = "<%= @compare_json %>";
        compareJson = makeValidJSON.validate(compareJson);
        compareJson = JSON.parse(compareJson);
        if (compareJson != "") {
            displayCompareResults(compareJson);
        }
    });
</script>
